services:
  ibkr-tws-mcp:
    build: .
    ports:
      - "${MCP_HTTP_PORT:-8080}:8080"
    environment:
      # TWS connection settings - host.docker.internal resolves to the Docker host
      # This allows the container to connect to TWS running on your host machine
      TWS_HOST: ${TWS_HOST:-host.docker.internal}
      TWS_PORT: ${TWS_PORT:-7496}
      TWS_CLIENT_ID: ${TWS_CLIENT_ID:-0}
      TWS_TIMEOUT: ${TWS_TIMEOUT:-30}
      # MCP_HOST is set to 0.0.0.0 inside Docker to allow container port mapping
      # The actual security boundary is at the Docker host level (ports section)
      MCP_HOST: "0.0.0.0"
      MCP_HTTP_PORT: "8080"
      DEBUG: ${DEBUG:-false}
      ENABLE_ORDER_EXECUTION: ${ENABLE_ORDER_EXECUTION:-false}
    restart: unless-stopped
